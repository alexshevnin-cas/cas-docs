# CAS Cabinet & BI — Стратегия и роадмап

> **Версия:** 2.0
> **Дата:** 2026-02-06
> **Статус:** Готов к обсуждению с разработкой
> **Источники:** descdocs, интервью клиентов (Жвиков, Мельников, Савенков), обсуждение Osyka 02.02

---

## 1. Стратегическая цель

Снизить зависимость выручки от ручного труда и поднять уровень прозрачности/аналитики так, чтобы CAS мог расти и брать крупнее клиентов, не ломая SDK и текущий оборот.

### Проблема
- Кабинет не дифференцирован по типам клиентов (все видят одно и то же)
- Ограниченная аналитика (нет Fill Rate, нет разбивки по SDK-версиям, нет когортного LTV)
- Значимая часть ценности создаётся ручным трудом и разрозненными инструментами
- Нет self-service (экспорт, сохранённые отчёты, онбординг)
- Нет маркетинговых инструментов (нотификации, upsell)
- Клиенты собирают данные из 3 источников вручную (CAS + MMP + UA sources)

### Ожидаемые результаты
- Рост конверсии новых клиентов (онбординг, self-service)
- Снижение нагрузки на support и ручной труд
- Рост upsell L1→L2→Pub (маркетинговые триггеры)
- Повышение retention клиентов (ценность кабинета)
- Возможность масштабировать на крупных клиентов

---

## 2. Текущее состояние и ограничения

**Конец 2025:** CAS предоставляет кастомерам сервис управления рекламной монетизацией, однако значимая часть ценности создаётся за счёт ручного труда и разрозненных инструментов без единой целостной картины.

**Ограничения:**
- Ресурсы ограничены → модернизация поэтапно, без резких изменений для SDK и оборота
- Фокус на Customer Admin (B2B/CMS) и единой BI как параллельного контура транзишна из 1С
- Новый контур развивается рядом с текущей системой и становится целевой точкой миграции

**Принцип:** Идём от описания процессов и реального Customer Experience к технологии. НЕ НАОБОРОТ.

---

## 3. Архитектурные требования

> Ключевые ограничения для инженерных решений.

### R1. Single Source of Truth
Единый "источник правды" по ключевым метрикам монетизации (revenue, impressions, eCPM, fill-rate и др.) и единые определения метрик, используемые во всех UI и выгрузках.

### R2. Layered Data Platform

Data platform строится как двухслойная архитектура, где добавление нового источника данных не требует переработки пайплайна.

#### Ingestion Layer (сырые данные)
Слой приёма данных из произвольных источников. Каждый источник — абстрактный коннектор, который знает только свой формат и умеет класть данные в raw storage.

Типы источников (абстрактные сущности, не конкретные продукты):

| Тип источника | Какие данные поставляет | Примеры имплементаций |
|---------------|------------------------|----------------------|
| **Mediation Platform** | Revenue, impressions, eCPM, fill rate, ad requests, network-level данные | CAS SDK, AppoDeal, MAX, ironSource |
| **MMP (Attribution)** | Installs, events, attribution (source/campaign/creative), spend | AppsFlyer, Adjust, Tenjin, Singular |
| **Ad Network** | Network-specific revenue, bid data | AdMob, Meta AN, Unity Ads, Pangle |
| **Product Analytics** | Sessions, retention, custom events, funnels | Firebase, Amplitude, AppMetrica |
| **UA Source** | Spend, impressions, clicks, installs per campaign | Facebook Ads, Google Ads, TikTok Ads |

Принцип: новый источник = новый коннектор (adapter). Никаких изменений в слоях выше.

#### Semantic Layer (нормализованные сущности)
Единый слой бизнес-понятий. Все дашборды, репорты и выгрузки работают ТОЛЬКО с этим слоем. Semantic layer оперирует каноническими сущностями:

| Сущность | Определение | Может прийти из |
|----------|-------------|-----------------|
| **Install** | Первый запуск приложения пользователем | MMP, Product Analytics, CAS SDK |
| **DAU** | Уникальный пользователь с активностью за день | CAS SDK, Product Analytics |
| **Impression** | Показ рекламного объявления | Mediation Platform, Ad Network |
| **Revenue** | Доход от рекламного показа | Mediation Platform, Ad Network |
| **Spend** | Затраты на привлечение пользователя | MMP, UA Source |
| **Session** | Период активности пользователя | CAS SDK, Product Analytics |
| **Event** | Кастомное in-app событие | MMP, Product Analytics |
| **Attribution** | Привязка пользователя к источнику трафика | MMP |
| **Cohort** | Группа пользователей по дате install + свойствам | Вычисляемая |

Принцип: на этом слое не важно, откуда пришёл Install — из AppsFlyer, Firebase или CAS SDK. Это Install с каноническими полями (user_id, date, country, source, ...). Все производные метрики (ARPDAU, ROAS, LTV, Retention, CPI) вычисляются из канонических сущностей.

#### Почему это критично
- **Сейчас:** L2 клиенты собирают данные из 3 сервисов вручную. Каждая новая интеграция — переработка пайплайна.
- **Цель:** Подключил коннектор → данные автоматически нормализуются → появляются в BI без изменений UI и витрин.
- **Масштабируемость:** Новый MMP, новая сеть, новый UA source = только новый adapter на ingestion layer. Semantic layer, витрины и UI не трогаются.

### R3. Role-Based UI (same product, different views)
UI — единый продукт с разными views по ролям. Различия достигаются:
- Правами доступа (permissions)
- Набором доступных экранов/виджетов
- Уровнем детализации и доступными разрезами

Набор доступных метрик зависит от подключённых источников: без MMP клиент видит метрики из Mediation Platform (revenue, impressions, DAU). С подключённым MMP — дополнительно ROAS, LTV, когортный анализ по источникам трафика.

---

## 4. Роли

| Роль | Кто | Что видит |
|------|-----|-----------|
| **Customer — PubC** | Кандидат в паблишинг | CPI, Retention, базовые метрики, бенчмарки |
| **Customer — L1** | Базовый клиент медиации | Revenue, DAU, ARPDAU, eCPM, Fill Rate (агрегат) |
| **Customer — L2** | Продвинутый клиент | L1 + сети, версии SDK/App, saved views, экспорт, unified report |
| **Customer — Pub** | Публикуемый разработчик | L1 + Profit, ROAS, предиктивный LTV, health indicator |
| **Ads Operator** | Настройщик монетизации (внутр.) | Monetization Management, SDK config, waterfall |
| **Management** | C-level, Admin, BD | Portfolio overview, агрегации по клиентам, churn risks |

---

## 5. Scope

### Что делаем
1. Новый UI фреймворк + BI на собственном движке
2. Вынести 1С — проприетарный стек для паблишинга (legacy transition)
3. Расширить бизнес-логику: возможность добавлять свои сети и 3rd Party SDK
4. End-to-end контур экспериментов: сплитовалка → self-service запуск → experiment registry с BI
5. Единый дизайн-код, брендбук, последовательное улучшение интерфейсов

### Чего НЕ делаем (сейчас, но стремимся)
- Изменения бизнес-логики
- Подключение собственных рекламных сетей
- Работа с другими 3rd-party SDKs
- User-level data science (предиктивные модели на уровне пользователя)
- Замена in-house BI кастомеров

### Технологический выбор
CAS настаивает на собственном стеке — это упрощает развитие и поддержку. Но для L2–L3 клиентов с собственным стеком потребуются транзишн-тулы и адаптеры (интеграция с AppsFlyer/Adjust, API).

---

## 6. Потоки работ (Streams)

### Stream 1: Customer BI

**Цель:** Дать клиентам инструменты для понимания и оптимизации монетизации.

| Компонент | Описание | Приоритет | Источник |
|-----------|----------|-----------|----------|
| Quick View | Виджеты с ключевыми метриками (card layout, как Voodoo) | P1 | Стратегия + интервью |
| Reports | Гибкие отчёты: graph + table (как Amplitude) | P1 | Стратегия + Савенков |
| Экспорт | Excel, CSV, PDF, Copy. Очевидная кнопка! | P1 | Савенков (не нашёл кнопку) |
| Сравнение периодов | Inline compare (как Stripe, App Store Connect) | P1 | Савенков |
| Saved Views | Сохранение пресетов фильтров (текущие не работают) | P2 | Савенков |
| Deep Linking / Share | Состояние в URL + share link (как Amplitude) | P2 | Савенков |
| Anomaly Detection | Подсветка нулей и аномалий | P2 | Стратегия |
| Unified Report | Spend + Revenue + Events по GEO + AdType | P2 | Савенков (главная боль L2) |
| eCPM per Ad Type | Разделённый eCPM вместо бесполезного среднего | P1 | Савенков |
| DAU в дашборде | Cross-verification с Firebase/Amplitude | P2 | Савенков |
| Предиктивный LTV | LTV forecast (есть внутри, вынести наружу) | P2 | Жвиков, Мельников, Appodeal |
| CAS ↔ MMP интеграция | Partner integration с AppsFlyer/Adjust | P3 | Савенков (AppoDeal уже делает) |
| Metric Education | Рекомендуемые метрики по дефолту | P3 | Савенков |
| Бенчмарки | Средние по сети CAS (для PubC и L2) | P3 | Савенков, стратегия |

**Зависимости:** Бэкенд API метрик, data layer (R2).

**UX-референсы:** Amplitude (graph+table, share), Stripe (inline compare), AppsFlyer (metric defaults). См. `05-research/competitive-ux-reference.md`.

---

### Stream 2: Customer Cabinet

**Цель:** Сделать кабинет удобным инструментом самообслуживания.

| Компонент | Описание | Приоритет | Источник |
|-----------|----------|-----------|----------|
| Тёмная тема | По умолчанию | P1 | Стратегия, подтверждено |
| Адаптация под тип клиента | Разный scope метрик/фильтров (R3) | P1 | Стратегия |
| Фильтры UX | Chips, кастомные tiers стран, visible selection | P1 | Савенков (10 UX-багов) |
| Мультипользовательский доступ | Добавлять пользователей, роли | P2 | Никитин (ex-client) |
| Нотификации | Operational + Marketing | P2 | Стратегия |
| Help/FAQ | Встроенная справка | P2 | Стратегия |
| Payments UI | Переделать отображение платежей | P1 | Osyka |
| Net Income | Revenue после UA Cost И комиссии CAS | P2 | Мельников |

**Зависимости:** Сегментация клиентов в бэкенде (R3).

---

### Stream 3: Publisher & PubC

**Цель:** Привлечение новых разработчиков + прозрачность для publishing-партнёров.

#### PubC (Candidate Portal)

| Компонент | Описание | Приоритет | Источник |
|-----------|----------|-----------|----------|
| Self-service онбординг | Upload APK → автотест → результаты за 3 дня | P1 | Мельников (Voodoo) |
| Базовые метрики | CPI, Retention D1/D3/D7, Playtime | P1 | Стратегия, Voodoo |
| Status badge | Индикатор потенциала (green/yellow/red) | P1 | Voodoo, Жвиков |
| Креативы | Upload + перформанс table (Spend/Clicks/Installs/CPI) | P2 | Voodoo, Мельников |
| Бенчмарки | Сравнение с категорией | P2 | Стратегия |
| Путь к паблишингу | CTA для перехода | P2 | Стратегия |
| Лендинг | "Submit your game", AppQuantum как референс | P1 | Descdocs |

**UX-референс:** Voodoo (self-service, status badges, creative table). См. `assets/competitive/voodoo-*.png`.

#### Pub (Publishing Partners)

| Компонент | Описание | Приоритет | Источник |
|-----------|----------|-----------|----------|
| Предиктивный LTV | Для приоритизации разработки (не UA) | P2 | Жвиков, Мельников |
| Health indicator | Green/yellow/red по проекту | P2 | Жвиков |
| ROAS в кабинете | Без Tenjin | P2 | Мельников |
| A/B-тесты в дашборде | Comparison view по версии/сегменту | P3 | Мельников |
| Тренды рынка | Хайпящие жанры (Mira Trends как референс) | P3 | Мельников |

**Примечание:** Маленькие Pub-студии (1-3 чел.) считают детальный BI "перебором". Возможно, нужен Pub-lite scope.

---

### Stream 4: Internal Tools

**Цель:** Автоматизация внутренних процессов, снижение ручного труда.

| Компонент | Описание | Горизонт |
|-----------|----------|----------|
| Monetisation Management | Управление настройками монетизации | H1 |
| SDK Release Process | Автоматизация процесса релиза SDK | H1 |
| Quality Control | Контроль качества настроек | H1 |
| Automation | Автоматизация рутинных операций | H1 |
| Onboarding Process | Автоматизация онбординга клиентов | H1 |
| Docs / FAQ AI Agent | AI-агент для документации и FAQ | H1 |
| Bots | Автоматизация через ботов | H1 |
| Portfolio Overview BI | Обзор портфолио для Management (R3) | H1 |

---

### Stream 5: RND

**Цель:** Инструменты для экспериментов и оптимизации монетизации.

| Компонент | Описание | Горизонт |
|-----------|----------|----------|
| A/B Testing Split Engine | Детерминированная сплитовалка, self-service запуск | H1-H2 |
| Experiment Registry | Единый реестр экспериментов с результатами в BI | H2 |
| New Networks | Подключение новых рекламных сетей | H1 |

**Связь:** Гипотезы R&D — `03-product/rnd-hypotheses.md` (13 гипотез для тестирования).

---

### Stream 6: Marketing

**Цель:** Конверсия и retention через кабинет и коммуникации.

#### Нотификации

| Тип | Пример | Цель |
|-----|--------|------|
| Operational | "SDK 4.5 доступен" | Поддержка |
| Diagnostic | "Сеть X не передаёт данные 2 дня" | Retention |
| Growth | "Ваш eCPM вырос на 15%" | Engagement |
| Upsell | "Клиенты с вашим DAU зарабатывают на 30% больше" | Конверсия |
| Educational | "Гайд: оптимизация rewarded" | Вовлечение |

#### Контент-маркетинг

| Направление | Описание |
|-------------|----------|
| Тренды рынка | Дайджесты "что хайпит в Google Play / App Store" |
| Позиционирование "агент, не издатель" | Дифференциатор от Azur/DACI/Supersonic |
| Telegram-присутствие | Органический канал привлечения |
| Экспертный контент по монетизации | Bid floor, eCPM decay, ad format selection |
| Voodoo-style self-service лендинг | "Submit your game" → автотест |

#### Точки контакта

1. Welcome banner — при первом входе
2. Insight cards — рекомендации на основе данных
3. Empty states — возможность обучить
4. Milestone celebrations — "Первые $1000!"
5. Comparison prompts — бенчмарки

#### Email-триггеры

| Событие | Email |
|---------|-------|
| Регистрация | "Добро пожаловать!" |
| 24ч без интеграции | "Нужна помощь?" |
| Первые данные | "Ваш первый доход!" |
| 48ч без данных | "Проверьте настройки" |
| 7 дней без визита | "Посмотрите, как растёт доход" |

#### Upsell-триггеры

| Триггер | Действие |
|---------|----------|
| DAU > 100K, ARPDAU низкий | Предложить L2 / консультацию |
| Retention D1 < 20% | Предложить продуктовую помощь |
| L1 > 6 месяцев, стабильный рост | Предложить паблишинг |

---

## 7. Временные горизонты

### H1 2026 — "Навести порядок" (экстенсивный рост)

Фокус: больше клиентов, лучше витрина, не зависим от BI-инфраструктуры.

| Stream | Что | Зависимости |
|--------|-----|-------------|
| Cabinet | Новый дизайн в тёмной теме | Дизайнер |
| Cabinet | Payments UI редизайн | Только фронтенд |
| BI | L1 Aggregate — агрегированные данные | Минимальные |
| BI | UX-фиксы (фильтры, экспорт, eCPM per type) | Минимальные |
| PubC | Лендинг "Submit your game" (AppQuantum стиль) | Никита |
| Internal | Monetisation Management, SDK Process, QC, Automation | Вова + команда |
| Internal | Docs/FAQ AI Agent, Bots | — |
| Infra | Tech Debt: индексация БД, оптимизация запросов | Вова + команда |
| RND | New Networks | — |

### H2 2026 — "Умные инструменты" (качественный рост)

Фокус: deeper analytics, зависит от BI-инфраструктуры (Борис + data-инженеры).

| Stream | Что | Зависимости |
|--------|-----|-------------|
| BI | L2 Dashboard ILRD + когорты | BI инфраструктура |
| BI | Unified Report (Spend + Revenue + Events) | BI + MMP интеграция |
| BI | Предиктивный LTV (вынести наружу) | BI инфраструктура |
| PubC | Candidate Portal (self-service тестирование) | Лендинг + SDK |
| Pub | Publisher BI Dashboard + Cabinet | BI инфраструктура |
| RND | A/B Split Engine + Experiment Registry | BI инфраструктура |
| RND | Portfolio Overview BI | BI инфраструктура |
| UA | Campaign/Network Management, Upload | BI + интеграции |
| UA | Creatives A/B tests, Creatives Generation | BI + интеграции |
| UA | Own Inventory Access | Обсуждение |
| Cabinet | Self-service (клиенты подключают свои сети) | Обсуждение |

---

## 8. Фазы реализации

### Фаза 1: MVP BI (P1) — H1

**Цель:** Базовая функциональность для L1.

| Задача | Зависимости |
|--------|-------------|
| Quick View с 5 виджетами | API метрик |
| Reports с базовыми фильтрами (graph + table) | API фильтров |
| Тёмная тема | — |
| Сравнение периодов (inline) | — |
| Экспорт CSV (очевидная кнопка) | — |
| eCPM per Ad Type (не агрегированный) | — |
| UX-фиксы (фильтры, chips, date position) | — |

**Критерий готовности:** L1-клиент может видеть Revenue, DAU, ARPDAU, eCPM (per type), Fill Rate с разбивкой по дате/app/ad type. Экспорт и сравнение периодов работают.

### Фаза 2: L2 Features (P2) — H1-H2

**Цель:** Расширенная аналитика для L2.

| Задача | Зависимости |
|--------|-------------|
| Разбивка по SDK/App Version | API version data (ILRD merge) |
| Метрики по сетям | API network data |
| DAU в дашборде | SDK data |
| Saved Views (работающие) | Бэкенд хранения |
| Deep Linking / Share Link | — |
| Export Excel | — |

**Критерий готовности:** L2-клиент может диагностировать проблемы по версиям и сетям, сохранять отчёты и делиться ссылками.

### Фаза 3: Onboarding + PubC (P2) — H2

**Цель:** Привлечение и квалификация новых клиентов.

| Задача | Зависимости |
|--------|-------------|
| Welcome flow | — |
| Квалификационная анкета | — |
| Self-service Game Test (Voodoo-style) | Лендинг + SDK |
| Status badge (green/yellow/red) | API метрик |
| PubC-метрики (CPI, Retention, Playtime) | API retention, ROAS |
| Creative upload + performance | — |
| Бенчмарки | Data warehouse |

### Фаза 4: Marketing (P3) — H2

**Цель:** Конверсия и retention.

| Задача | Зависимости |
|--------|-------------|
| In-app нотификации | Notification service |
| Email-триггеры | Email service |
| Insight cards | ML/Rules engine |
| Upsell-баннеры | — |

---

## 9. Диаграмма зависимостей

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  ┌──────────────┐     ┌──────────────┐                              │
│  │  Data Layer  │────▶│  BI Engine   │                              │
│  │  (R1, R2)    │     │  (Semantic)  │                              │
│  └──────┬───────┘     └──────┬───────┘                              │
│         │                    │                                       │
│         ▼                    ▼                                       │
│  ┌─────────────┐     ┌─────────────┐     ┌──────────────┐          │
│  │ Quick View  │     │  Reports    │     │ Internal BI  │          │
│  │ (L1, Pub)   │     │ (L2, Admin) │     │ (Ads Ops,    │          │
│  └──────┬──────┘     └──────┬──────┘     │  Management) │          │
│         │                   │             └──────┬───────┘          │
│         └─────────┬─────────┘                    │                  │
│                   │                              │                  │
│                   ▼                              ▼                  │
│         ┌──────────────────┐          ┌──────────────────┐         │
│         │   Onboarding     │          │  RND Split       │         │
│         │   + PubC Portal  │          │  Engine + A/B    │         │
│         └────────┬─────────┘          └──────────────────┘         │
│                  │                                                   │
│                  ▼                                                   │
│         ┌──────────────────┐                                        │
│         │    Marketing     │                                        │
│         │  (notifications, │                                        │
│         │   email, upsell) │                                        │
│         └──────────────────┘                                        │
│                                                                     │
│  ── Параллельно ──────────────────────────────────────────────      │
│  ┌──────────────────┐     ┌──────────────────┐                      │
│  │  Internal Tools  │     │  Legacy 1С       │                      │
│  │  (Automation,    │     │  Transition      │                      │
│  │   SDK, QC)       │     │                  │                      │
│  └──────────────────┘     └──────────────────┘                      │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 10. Организация бэклогов

Для каждого направления — свой логический бэклог (отдельная вкладка в общем пространстве):

| Бэклог | Owner | Содержание |
|--------|-------|-----------|
| Design | Дизайнер (на проект) | Единый дизайн-код, брендбук, компоненты |
| B2B / Customer Admin | Product | Cabinet, BI, Payments, фильтры |
| Internal Tooling | Engineering | Monetization Mgmt, SDK, QC, Bots |
| BI / Data | Data Engineering | Data layer, ILRD, когорты, витрины |
| Marketing | Marketing | Нотификации, email, контент, лендинги |
| RND | RND | Split engine, experiments, new networks |

---

## 11. Открытые вопросы

### Архитектурные
1. Источник данных для Retention и ROAS (PubC) — ILRD или альтернатива?
2. Хранение Saved Views — на бэкенде или localStorage?
3. Notification service — использовать существующий или новый?
4. Как обрабатывать клиентов с существующими аккаунтами в сетях?

### Продуктовые
5. **Дифференциация Pub по размеру студии** — маленькие студии считают детальный BI "перебором". Нужен ли Pub-lite vs Pub-full? (интервью Жвиков)
6. **Бенчмарки** — откуда брать данные по категориям? Расширить scope на L2 (не только PubC). (интервью Савенков)

### Бизнес-возможности
7. **Desktop/Extension SDK монетизация** — десктопный трафик дороже мобильного, нет конкурентов с нормальным SDK. Новая ниша? (интервью Савенков)
8. **CAS ↔ AppsFlyer/Adjust Partner Integration** — AppoDeal уже делает. Конкурентное преимущество. (интервью Савенков)

---

## Связанные документы
- User stories: `03-product/user-stories.md`
- Справочник метрик: `04-bi/metrics-dictionary.md`
- Фильтры: `04-bi/filters.md`
- Гипотезы R&D: `03-product/rnd-hypotheses.md`
- UX-референсы конкурентов: `05-research/competitive-ux-reference.md`
- Дизайн-спек BI: `03-product/design-spec-bi.md`
- Бизнес-модель: `02-business-model/cas-business-model.md`
